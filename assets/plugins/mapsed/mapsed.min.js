/*! Pace Builder - v1.0.0 - 2016-10-22
 * Copyright (c) 2016; 
 * Licensed GPLv2+ */
!function($){"use strict";var _plugInName="mapsed",_plugInInstances=1;$.fn.mapsed=function(options){function onPlaceSelect(element){var $vw=(element.parents(".mapsed-root"),element.parents(".mapsed-view")),model=getViewModel($vw);settings.onSelect(_plugIn,model)&&closeTooltips()}function onPlaceEdit(element){var $root=element.parents(".mapsed-root"),lat=$root.find(".mapsed-lat").val(),lng=$root.find(".mapsed-lng").val(),marker=findMarker(lat,lng);closeTooltips(),marker.showTooltip(!0)}function onPlaceAdd(evt){evt.preventDefault();var centre=_gMap.getCenter(),bounds=new gm.LatLngBounds,newMarker=createMarker("New place",centre,!0,"new");attachTooltip(newMarker),_markers.push(newMarker),bounds.extend(centre),gm.event.addListener(newMarker,"click",function(evt){var currMarker=this;if(closeTooltips(),settings.onAdd){$(currMarker.tooltip.content);settings.onAdd(_plugIn,currMarker)}else currMarker.showTooltip(!0)}),gm.event.addListener(newMarker,"dragend",function(evt){var currMarker=this;currMarker.details.lat=evt.latLng.lat(),currMarker.details.lng=evt.latLng.lng();var tip=$(currMarker.tooltip.content);tip.find(".mapsed-lat").val(currMarker.details.lat),tip.find(".mapsed-lng").val(currMarker.details.lng)}),gm.event.trigger(newMarker,"click")}function onPlaceDelete(element){var $root=element.parents(".mapsed-root"),$vw=$root.find(".mapsed-view"),model=getViewModel($vw);if(settings.onDelete(_plugIn,model)){var marker=findMarker(model.lat,model.lng);marker.setMap(null),marker.tooltip=null}}function onPlaceSave(element){var root=element.parents(".mapsed-root"),$rw=root.find(".mapsed-edit"),errors="",place=getViewModel($rw);errors=settings.onSave(_plugIn,place);var errCtx=$rw.find(".mapsed-error");if(errors&&errors.length>0)return void errCtx.text(errors);errCtx.text("");var marker=findMarker(place.lat,place.lng);jQuery.extend(marker.details,place),root.find(".mapsed-marker-type").val("custom"),root.find(".mapsed-user-data").val(place.userData),marker.showTooltip(!1)}function gmMapLoaded(){var gmToolBtns=$(_mapContainer.find(".gm-style-mtc"));if(gmToolBtns.length>0){var gmLineHeight=$(gmToolBtns[0]).css("line-height");$(_mapContainer.find(".mapsed-control-button")).css("line-height",gmLineHeight)}if(_helpDlg){var btnContainer=_helpBtn,dialogLeft=btnContainer.position().left;dialogLeft+=btnContainer.width()/2,dialogLeft-=_helpDlg.width()/2;var dialogTop=btnContainer.position().top;dialogTop+=2*btnContainer.height(),_helpDlg.css("z-index",999).css("position","absolute").css("top",dialogTop).css("right","1%").css("width","20%"),settings.showHelpOnLoad&&_helpBtn.click&&_helpBtn.trigger("click")}settings.findGeoOnLoad}function gmPlaceSelected(places,status,pagination){_firstSearch||0==_pageNum&&clearMarkers(),_firstSearch=!1,"ZERO_RESULTS"==status&&_plugIn.showMsg("No results","Your search returned no results.");for(var place,bounds=new gm.LatLngBounds,i=0;place=places[i];i++)if(place.reference){var pos=place.geometry.location,marker=addMarker(place,pos,"google",bounds);normaliseFormattedAddress(marker.details,place.formatted_address),bounds.extend(pos),_gMap.fitBounds(bounds)}pagination&&(_moreBtn[0].disabled=!pagination.hasNextPage,pagination.hasNextPage&&gm.event.addDomListenerOnce(_moreBtn[0],"click",function(){event.preventDefault(),_pageNum++,pagination.nextPage()}))}function getPlaceDetails(forMarker,callback){if(forMarker.details&&forMarker.details.reference){var request={reference:forMarker.details.reference};_placesApi.getDetails(request,function(placeDetails,status){forMarker.details.isLoaded=!0,status==gp.PlacesServiceStatus.OK&&(normalisePlacesApiAddress(forMarker.details,placeDetails),callback(forMarker))})}}function gmBoundsChanged(){var bounds=_gMap.getBounds();bounds&&_gmSearchBox.setBounds(bounds),_areBoundsSet=!0}function buildMsg(title,msg,doConfirm,prompt,callback){var $modal=null,html="",buttons="";title=title||"",msg=msg||"",$modal=_mapContainer.find(".mapsed-modal"),$modal.length>0&&$modal.remove(),buttons+="<div class='mapsed-modal-button-bar'>",prompt&&prompt.length>0&&(buttons+="<p class='prompt'>"+prompt+"</p>"),buttons+="<div class='mapsed-modal-buttons'>",doConfirm?(buttons+="<button class='ok'>OK</button>",buttons+="<button class='cancel'>Cancel</button>"):buttons+="<button class='close'>OK</button>",buttons+="</div>",buttons+="</div>",html="<div class='mapsed-modal'><h3>"+title+"</h3><div><div class='mapsed-modal-message'>"+msg+"</div>"+buttons+"</div></div>",$modal=$(html).appendTo(_mapContainer),$modal.find("button").on("click",function(){var $btn=$(this);$modal.fadeOut(),$btn.hasClass("cancel")||callback&&callback($btn)}).end().fadeIn()}function addMarker(model,position,markerType,inBoundary){var marker=createMarker(model.title,position,!1,markerType);return jQuery.extend(marker.details,model),attachTooltip(marker),_markers.push(marker),inBoundary.extend(position),gm.event.addListener(marker,"click",function(){var m=this;closeTooltips(),m.showTooltip(!1)}),model.autoShow&&marker.showTooltip(!1),_areBoundsSet=!0,marker}function applyTemplate(tmpl,model,$ctx){tmpl=replaceAll("{TITLE}",model.title,tmpl),tmpl=replaceAll("{STREET}",model.street,tmpl),tmpl=replaceAll("{WEBSITE}",model.website,tmpl),tmpl=replaceAll("{IMG","<img",tmpl),$ctx.html($(tmpl).html())}function hideEmpty(model,$vw){$vw.find(".mapsed-name").parent().toggle(model.title&&model.title.length>0),$vw.find(".mapsed-street").toggle(model.street&&model.street.length>0);var $ws=$vw.find(".mapsed-website");model.website&&model.website.length>0?$ws.show().css("display","block"):$ws.hide();var settings=_plugIn.getSettings();if(settings.onSelect||settings.onSave||settings.onDelete){var showSelect,showSave,showDelete,canEdit;canEdit=model.canEdit,"google"==model.markerType&&(canEdit=!1),showSelect=null!=settings.onSelect,showSave=null!=settings.onSave&&canEdit,showDelete=null!=settings.onDelete,$vw.find(".mapsed-select-button").toggle(showSelect),$vw.find(".mapsed-edit-button").toggle(showSave),$vw.find(".mapsed-delete-button").toggle(showDelete)}else $vw.find(".mapsed-buttons").hide()}function findMarker(lat,lng){for(var marker=null,i=0;i<_markers.length;i++){var m=_markers[i];if(m.position.lat()==lat&&m.position.lng()==lng){marker=m;break}}return marker}function addSearch(){var id="mapsed-search-box-"+_instance;if(_searchBox=$("#"+id),!(_searchBox.length>0)){var so=settings.searchOptions,html="<input type='text' id='"+id+"' class='mapsed-searchbox' autocomplete='off' ";html+="placeholder='",html+=so.enabled&&so.placeholder?so.placeholder:"Search ...",html+="' ",so.enabled&&so.initSearch&&so.initSearch.length>0&&(html+=" value='"+so.initSearch+"'"),html+=" />",_searchBox=$(html).appendTo(_mapContainer),_gmSearchBox=new gp.SearchBox(_searchBox[0]),_gMap.controls[gm.ControlPosition.TOP_LEFT].push(_searchBox[0]),gm.event.addListener(_gmSearchBox,"places_changed",function(){var searchFor=_searchBox.val();doSearch(searchFor)}),gm.event.addListener(_gMap,"bounds_changed",gmBoundsChanged),_searchBtn=createControlButton(settings.ToolbarButtons.Go,gm.ControlPosition.TOP_LEFT,"mapsed-search-button mapsed-control-button",function(evt){evt.preventDefault();var searchFor=_searchBox.val();doSearch(searchFor)}),_moreBtn=createControlButton(settings.ToolbarButtons.More,gm.ControlPosition.TOP_LEFT,"mapsed-more-button mapsed-control-button",null),_moreBtn[0].disabled=!0}}function addNewPlaceButton(){_addBtn||(_addBtn=createControlButton(settings.ToolbarButtons.AddPlace,gm.ControlPosition.TOP_RIGHT,"mapsed-add-button mapsed-control-button",onPlaceAdd))}function addCloseButton(){if(!_closeBtn){var onCloseEvent=function(evt){if(evt.preventDefault(),_fullWin){var closeMap=!0;settings.onClose&&(closeMap=settings.onClose(_plugIn)),closeMap&&_fullWin&&_plugIn.closeMap()}};_closeBtn=createControlButton(settings.ToolbarButtons.CloseMap,gm.ControlPosition.TOP_RIGHT,"mapsed-close-button mapsed-control-button",onCloseEvent),$("body").on("keyup",function(evt){evt.preventDefault(),27==evt.which&&onCloseEvent(evt)})}}function addGeoLocationButton(){if(!_geoBtn){var onClickEvent=function(evt){_plugIn.setMapCentreByGeo()};_geoBtn=createControlButton(settings.ToolbarButtons.Geo,gm.ControlPosition.TOP_RIGHT,"mapsed-geo-button mapsed-control-button",onClickEvent)}}function addHelpButton(){if(!_helpDlg){_helpBtn=createControlButton(settings.ToolbarButtons.Help,gm.ControlPosition.TOP_RIGHT,"mapsed-help-button mapsed-control-button",function(evt){evt.preventDefault(),_helpDlg.fadeToggle(),_helpBtn.toggleClass("open")});var helpHtml=settings.getHelpWindow();_helpDlg=$(helpHtml).appendTo(_mapContainer).click(function(){$(this).fadeOut(),_helpBtn.toggleClass("open")}),_helpDlg.fadeOut()}}function createControlButton(buttonText,ctrlPos,addClass,onClickEvent){var btn=null,markUp="",classes="",tooltip="";if(addClass&&addClass.length>0&&(classes=" class='"+addClass+"' "),buttonText&&buttonText.length>0){var arrSplit=buttonText.split("|");buttonText=arrSplit[0],tooltip=arrSplit.length>1?" title='"+arrSplit[1]+"'":""}var markUp="<button "+classes+tooltip+">"+buttonText+"</button>";return btn=_plugIn.addMapControl(markUp,ctrlPos),onClickEvent&&btn.on("click",onClickEvent),btn}function clearMarkers(){if(_markers&&_markers.length>0)for(var i=0;i<_markers.length;i++){var currMarker=_markers[i];currMarker.tooltip=null,currMarker.setMap(null)}_markers=[]}function closeTooltips(){if(_markers&&_markers.length>0)for(var i=0;i<_markers.length;i++){var current=_markers[i];current.tooltip&&current.tooltip.close()}}function createMarker(title,latLng,isDraggable,type){var image=null;settings.getMarkerImage&&(image=settings.getMarkerImage(_plugIn,type,title));var marker=new gm.Marker({map:_gMap,icon:image,title:title,animation:gm.Animation.DROP,position:latLng,markerType:type,draggable:isDraggable});return marker.details={markerType:type,isLoaded:"google"!=type,lat:latLng.lat(),lng:latLng.lng(),title:"",street:"",website:"",canEdit:"new"==type||"custom"==type},marker}function attachTooltip(forMarker){if(forMarker.id){var item=$("#mapsed-"+forMarker.id);return item}var newId=_markers.length+1,d=forMarker.details;forMarker.id=newId;var item=$("<div id='mapsed-"+newId+"' class='mapsed-root'><input type='hidden' class='mapsed-lat' value='"+forMarker.position.lat()+"' /><input type='hidden' class='mapsed-lng' value='"+forMarker.position.lng()+"' /><input type='hidden' class='mapsed-can-edit' value='"+d.canEdit+"' /><input type='hidden' class='mapsed-reference' value='"+d.reference+"' /><input type='hidden' class='mapsed-user-data' value='"+d.userData+"' /><input type='hidden' class='mapsed-marker-type' value='"+forMarker.markerType+"' />"+getViewTemplate()+getEditTemplate()+"</div>");return forMarker.tooltip=new gm.InfoWindow,forMarker.tooltip.setContent(item[0]),forMarker.tooltip.marker=forMarker,forMarker.showTooltip=showTooltip,gm.event.addListener(forMarker.tooltip,"domready",function(){var iwOuter=$(".gm-style-iw"),$parent=iwOuter.parent(),mapWrap=iwOuter.closest(".ptpb-google-map-wrap"),bdclr=mapWrap.data("bdcolor"),bgclr=mapWrap.data("bgcolor");if(bdclr&&bgclr){var bgColor=hexToRGBA(bgclr,.9),bdColor=hexToRGBA(bdclr,.7),color=mapWrap.data("color");$parent.css({boxShadow:bdColor+"0px 1px 6px",borderColor:bdColor.replace("0.7","0.8"),backgroundColor:bgColor}).find(".mapsed-view").css("color",color);var iwBackground=iwOuter.prev();iwOuter.css("right",($parent.width()-iwOuter.width())/2).next().css({right:"8px",top:"8px"}),iwBackground.children(":nth-child(1)").css({display:"none"}),iwBackground.children(":nth-child(2)").css({display:"none"}),iwBackground.children(":nth-child(4)").css({display:"none"});var arrows=iwBackground.children(":nth-child(3)").find("> div").css("top","3px").find("div");arrows.css({boxShadow:bdColor+"0px 1px 6px",zIndex:100,border:"1px solid "+bdColor.replace("0.7","0.8"),borderTop:"none",left:"-2px",backgroundColor:bgColor}),arrows.first().css("left","8px")}}),forMarker.showTooltip(!1),item}function hexToRGBA(hex,alpha){if(hex.match("rgba"))return hex;var hex=hex.replace("#",""),r=parseInt(hex.substring(0,2),16),g=parseInt(hex.substring(2,4),16),b=parseInt(hex.substring(4,6),16),alpha=alpha||1;return"rgba("+r+","+g+","+b+","+alpha+")"}function showTooltip(inRwMode){var marker=this,tip=marker.tooltip,model=marker.details,$ele=$(tip.getContent()),$ro=$ele.find(".mapsed-view"),$rw=$ele.find(".mapsed-edit");_plugIn.getSettings();if(!model.isLoaded)return void getPlaceDetails(marker,function(forM){marker.showTooltip(inRwMode)});if($rw.toggle(inRwMode),$ro.toggle(!inRwMode),sanitise(model),inRwMode){var tmpl=getEditTemplate();applyTemplate(tmpl,model,$rw)}else{var tmpl=getViewTemplate();applyTemplate(tmpl,model,$ro),hideEmpty(model,$ro)}tip.close(),tip.open(_gMap,marker)}function getViewTemplate(){var html="<div class='map-info-box mapsed-view'><div class='point-title'>{TITLE}</div><div class='point-street'>{STREET}</div><table><tr class='mapsed-buttons'><td colspan='3'><button class='mapsed-select-button'>"+settings.ActionButtons.Select+"</button><button class='mapsed-edit-button'>"+settings.ActionButtons.Edit+"</button><button class='mapsed-delete-button'>"+settings.ActionButtons.Delete+"</button></td></tr></table></div>";return html}function getEditTemplate(){var html="<div class='mapsed-container mapsed-address-entry mapsed-edit'><h1>Edit Marker</h1><ul><li><label>Title<input class='mapsed-name' type='text' placeholder='e.g. John in New York' value='{TITLE}' /></label></li><li><label>Street<input class='mapsed-street' type='text' placeholder='e.g. 3 Hemington place' value='{STREET}' /></label></li></ul><div class='mapsed-buttons'><button class='mapsed-save-button'>"+settings.ActionButtons.Save+"</button><span class='mapsed-error'>&nbsp;</span></div></div>";return html}function getViewModel($vw){var $root=$vw.parents(".mapsed-root"),model={canEdit:"true"===$root.find(".mapsed-can-edit").val(),lat:$root.find(".mapsed-lat").val(),lng:$root.find(".mapsed-lng").val(),markerType:$root.find(".mapsed-marker-type").val()};return $vw.hasClass("mapsed-view")?(model.title=$vw.find(".point-title").text(),model.street=$vw.find(".point-street").html(),model.website=$vw.find(".point-image img").attr("href")):(model.title=$vw.find(".mapsed-name").val(),model.street=$vw.find(".mapsed-street").val(),model.website=$vw.find(".mapsed-website").val()),sanitise(model),model}function sanitise(place){place.canEdit||(place.canEdit=!1),place.lat||(place.lat=0),place.lng||(place.lng=0),place.title||(place.title=""),place.street||(place.street=""),place.website||(place.website="")}function addInitialPlaces(){var bounds=new gm.LatLngBounds;clearMarkers();var places=[];$.isArray(settings.showOnLoad)?places=settings.showOnLoad:places.push(settings.showOnLoad);for(var i=0;i<places.length;i++){var p=places[i],pos=new gm.LatLng(p.lat,p.lng),markerType="";markerType=p.reference&&p.reference.length>0?"google":"custom",addMarker(p,pos,markerType,bounds)}!settings.forceCenter,"undefined"!=typeof ptPbOptions&&"undefined"!=typeof ptPbOptions.isPb&&setTimeout(function(){_mapContainer.trigger("ptpb:map:initialPlaces:added")},500)}function doSearch(searchFor){var boundary=_gMap.getBounds();_pageNum=0,clearMarkers();var request={query:searchFor,bounds:boundary};_placesApi.textSearch(request,gmPlaceSelected),_searchBox.val(searchFor)}function normalisePlacesApiAddress(details,fromGP){var ac=fromGP.address_components,street=findPart(ac,"street_address");""===street&&(street=findPart(ac,"route"));findPart(ac,"locality"),findPart(ac,"administrative_area_level_1"),findPart(ac,"postal_code");details.street=street,details.title=fromGP.name||"",details.website=fromGP.website||""}function normaliseFormattedAddress(details,src){if(src){var elements=src.split(",");elements.length>=1&&(details.street=$.trim(elements[0])),elements.length>=2&&(details.town=$.trim(elements[1])),elements.length>=3&&(details.area=$.trim(elements[2])),elements.length>=4&&(details.postCode=$.trim(elements[3]))}}function findPart(addressParts,typeName,getShortVersion){if(null==addressParts||0==addressParts.length)return"";for(var value="",i=0;i<addressParts.length;i++){for(var item=addressParts[i],found=!1,j=0;j<item.types.length;j++){var addrType=item.types[j];if(addrType.toLowerCase()==typeName.toLowerCase()){found=!0;break}}if(found){value=getShortVersion?item.short_name:item.long_name;break}}return value}var DEFAULT_CENTER=new google.maps.LatLng(53.175148,-1.423908),DEFAULT_ZOOM=10,_plugIn=this,_searchBox=null,_gmSearchBox=null,_searchBtn=null,_moreBtn=null,_pageNum=0,_gMap=null,_mapContainer=null,_placesApi=null,_markers=[],_instance=-1,_fullWin=!1,_firstSearch=!0,_hasMapInitFired=!1,_areBoundsSet=!1,_helpBtn=null,_helpDlg=null,_closeBtn=null,_addBtn=null,_geoBtn=null,gm=null,gp=null,settings=$.extend({showOnLoad:null,ToolbarButtons:{Go:"Go",More:"More|There are more results available ...",AddPlace:"+|Add a place",CloseMap:"&times;|Close map",Geo:"&otimes;|Centre map based on your location",Help:"?|Show help"},ActionButtons:{Select:"Select",Edit:"Edit",Delete:"Delete",Save:"Save"},mapOptions:{zoom:DEFAULT_ZOOM,center:DEFAULT_CENTER,mapTypeId:google.maps.MapTypeId.ROADMAP},disablePoi:!1,allowAdd:!1,searchOptions:{enabled:!1,placeholder:"Location",initSearch:"",geoSearch:"5aside football near {POSITION}"},onSelect:null,onSave:null,onDelete:null,confirmDelete:!1,onClose:null,getMarkerImage:null,getHelpWindow:null,showHelpOnLoad:!1,allowGeo:!1,findGeoOnLoad:!1,forceCenter:!1},options||{});settings.mapOptions.styles=options.styles||void 0,this.getSettings=function(){return settings},this.getGoogleMap=function(){return _gMap},this.getMapContainer=function(){return _mapContainer},this.addMapControl=function(markUp,ctrlPos){var $control=null,$html=null;return $html=$(markUp),$control=$html.appendTo(_mapContainer),_gMap.controls[ctrlPos].push($control[0]),$control},this.disablePointsOfInterest=function(){_gMap.styles=[{featureType:"poi",stylers:[{visibility:"off"}]}]},this.closeMap=function(){_gMap=null,_helpDlg&&_helpDlg.fadeOut(),_mapContainer.fadeOut(function(){$(this).remove()}),_fullWin=!1},this.showMsg=function(title,msg,callback){buildMsg(title,msg,!1,"",callback)},this.showAddDialog=function(marker){marker.showTooltip(!0)},this.confirmMsg=function(title,msg,prompt,callback){buildMsg(title,msg,!0,prompt,callback)},this.setMapCentreByGeo=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(geoPos){var pos=new gm.LatLng(geoPos.coords.latitude,geoPos.coords.longitude);_gMap.setZoom(settings.mapOptions.zoom),_gMap.setCenter(pos),_geoBtn.addClass("is-active");var so=settings.searchOptions;if(so&&so.geoSearch&&so.geoSearch.length>0){var newLocation=pos.toUrlValue(),search=so.geoSearch.replace("{POSITION}",newLocation);doSearch(search)}so&&settings.showOnLoad&&addInitialPlaces()},function(err){_plugIn.showMsg("GEO Position",err.message)})};var replaceAll=function(find,replace,str){return void 0==replace&&(replace=""),str.replace(new RegExp(find,"g"),replace)},ctor=function(){var containerId=null;gm=google.maps,gp=google.maps.places,containerId=_mapContainer.attr("id"),_gMap=new gm.Map(document.getElementById(containerId),settings.mapOptions),window.gmap=_gMap,settings.disablePoi&&_plugIn.disablePointsOfInterest(),_placesApi=new gp.PlacesService(_gMap),_instance=_plugInInstances++,settings.onSelect&&_mapContainer.on("click","button.mapsed-select-button",function(e){e.preventDefault();var element=$(this);onPlaceSelect(element)}),settings.onSave&&(_mapContainer.on("click","button.mapsed-save-button",function(e){e.preventDefault();var element=$(this);onPlaceSave(element)}),_mapContainer.on("click","button.mapsed-edit-button",function(e){e.preventDefault();var element=$(this);onPlaceEdit(element)})),settings.onDelete&&_mapContainer.on("click","button.mapsed-delete-button",function(e){e.preventDefault();var element=$(this);if(settings.confirmDelete){var $vw=element.parents(".mapsed-view"),model=getViewModel($vw),msg="<strong>"+model.title+"</strong> will be deleted.";_plugIn.confirmMsg("Confirm Delete",msg,"Are you sure?",function(){onPlaceDelete(element)})}else onPlaceDelete(element)}),settings.allowGeo&&addGeoLocationButton(),settings.searchOptions.enabled&&addSearch(),(_fullWin||settings.onClose)&&addCloseButton(),null!=settings.showOnLoad&&addInitialPlaces(),settings.getHelpWindow&&addHelpButton(),settings.allowAdd&&addNewPlaceButton(),settings.onPreInit&&settings.onPreInit(_plugIn),gm.event.addListener(_gMap,"tilesloaded",function(evt){_hasMapInitFired||(gmMapLoaded(),_hasMapInitFired=!0,settings.onInit&&settings.onInit(_plugIn),_mapContainer.trigger("map_loaded"),settings.mapOptions.center&&_gMap.setCenter(settings.mapOptions.center))});var so=settings.searchOptions;so.enabled&&so.initSearch&&so.initSearch.length>0&&doSearch(so.initSearch),"undefined"!=typeof ptPbOptions&&"undefined"!=typeof ptPbOptions.isPb&&(gm.event.addListener(_gMap,"click",function(e){addMarker({canEdit:!0,title:""},e.latLng,"custom",new gm.LatLngBounds)}),gm.event.addListener(_gMap,"zoom_changed",function(e){$("#gmap-zoom-level").text(_gMap.getZoom()),$('#pt-form-module-settings input[name="zoom"]').val(_gMap.getZoom())}),gm.event.addListener(_gMap,"center_changed",function(e){var center=_gMap.getCenter().toString().replace(/\s|\(|\)/gi,"");$("#gmap-center").text(center),$('#pt-form-module-settings input[name="center"]').val(center)}),google.maps.event.addListenerOnce(_gMap,"idle",function(){google.maps.event.trigger(_gMap,"resize")})),_gMap.setZoom(settings.mapOptions.zoom),settings.mapOptions.center&&_gMap.setCenter(settings.mapOptions.center);var plugger="plugin_"+_plugInName;_mapContainer.data(plugger)||_mapContainer.data(plugger,_plugIn)};if(this.each(function(){_mapContainer=$(this),ctor()}),!this.length){var mapId="mapsed-full-window",_mapContainer=$("#"+mapId);_mapContainer.length||(_mapContainer=$("<div id='mapsed-full-window' class='mapsed-full-window'></div>"),_mapContainer.appendTo("body")),_fullWin=!0,ctor()}return this}}(jQuery);var GoogleMapThemes={"subtle-grayscale":[{featureType:"landscape",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",stylers:[{saturation:-100},{lightness:51},{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"road.arterial",stylers:[{saturation:-100},{lightness:30},{visibility:"on"}]},{featureType:"road.local",stylers:[{saturation:-100},{lightness:40},{visibility:"on"}]},{featureType:"transit",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"administrative.province",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"on"},{lightness:-25},{saturation:-100}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#ffff00"},{lightness:-25},{saturation:-97}]}],"blue-water":[{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#444444"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2f2f2"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#46bcec"},{visibility:"on"}]}],"pale-dawn":[{featureType:"administrative",elementType:"all",stylers:[{visibility:"on"},{lightness:33}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#f2e5d4"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#c5dac6"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"on"},{lightness:20}]},{featureType:"road",elementType:"all",stylers:[{lightness:20}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#c5c6c6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#e4d7c6"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#fbfaf7"}]},{featureType:"water",elementType:"all",stylers:[{visibility:"on"},{color:"#acbcc9"}]}],"blue-essence":[{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#e0efef"}]},{featureType:"poi",elementType:"geometry.fill",stylers:[{visibility:"on"},{hue:"#1900ff"},{color:"#c0e8e8"}]},{featureType:"road",elementType:"geometry",stylers:[{lightness:100},{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{visibility:"on"},{lightness:700}]},{featureType:"water",elementType:"all",stylers:[{color:"#7dcdcd"}]}],"apple-maps-esque":[{featureType:"landscape.man_made",elementType:"geometry",stylers:[{color:"#f7f1df"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#d0e3b4"}]},{featureType:"landscape.natural.terrain",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.business",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.medical",elementType:"geometry",stylers:[{color:"#fbd3da"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#bde6ab"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffe15f"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#efd151"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#ffffff"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"black"}]},{featureType:"transit.station.airport",elementType:"geometry.fill",stylers:[{color:"#cfb2db"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#a2daf2"}]}],retro:[{featureType:"administrative",stylers:[{visibility:"off"}]},{featureType:"poi",stylers:[{visibility:"simplified"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"water",stylers:[{visibility:"simplified"}]},{featureType:"transit",stylers:[{visibility:"simplified"}]},{featureType:"landscape",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{visibility:"off"}]},{featureType:"road.local",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"water",stylers:[{color:"#84afa3"},{lightness:52}]},{stylers:[{saturation:-17},{gamma:.36}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#3f518c"}]}],paper:[{featureType:"administrative",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{visibility:"simplified"},{hue:"#0066ff"},{saturation:74},{lightness:100}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"off"},{weight:.6},{saturation:-85},{lightness:61}]},{featureType:"road.highway",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"road.arterial",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"water",elementType:"all",stylers:[{visibility:"simplified"},{color:"#5f94ff"},{lightness:26},{gamma:5.86}]}],"flat-map":[{featureType:"all",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{visibility:"on"},{color:"#f3f4f4"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{weight:.9},{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#83cead"}]},{featureType:"road",elementType:"all",stylers:[{visibility:"on"},{color:"#ffffff"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"on"},{color:"#fee379"}]},{featureType:"road.arterial",elementType:"all",stylers:[{visibility:"on"},{color:"#fee379"}]},{featureType:"water",elementType:"all",stylers:[{visibility:"on"},{color:"#7fc8ed"}]}],gowalla:[{featureType:"administrative.land_parcel",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"landscape.man_made",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"simplified"},{lightness:20}]},{featureType:"road.highway",elementType:"geometry",stylers:[{hue:"#f49935"}]},{featureType:"road.highway",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{hue:"#fad959"}]},{featureType:"road.arterial",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"road.local",elementType:"labels",stylers:[{visibility:"simplified"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{hue:"#a1cdfc"},{saturation:30},{lightness:49}]}],subtle:[{featureType:"poi",stylers:[{visibility:"off"}]},{stylers:[{saturation:-70},{lightness:37},{gamma:1.15}]},{elementType:"labels",stylers:[{gamma:.26},{visibility:"off"}]},{featureType:"road",stylers:[{lightness:0},{saturation:0},{hue:"#ffffff"},{gamma:0}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{lightness:20}]},{featureType:"road.highway",elementType:"geometry",stylers:[{lightness:50},{saturation:0},{hue:"#ffffff"}]},{featureType:"administrative.province",stylers:[{visibility:"on"},{lightness:-50}]},{featureType:"administrative.province",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"labels.text",stylers:[{lightness:20}]}]};